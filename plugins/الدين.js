import fetch from 'node-fetch';

let handler = async (m, { conn, usedPrefix, command, text }) => {

    if (command === 'اسلام') {
        let taguser = m.sender.split('@')[0];

        let menu = `✦ أهلاً وسهلاً يا @${taguser} ✦ ✨

╔⏤━⌬〔📖 الدين الإسلامي〕⌬━⏤╗

✦❐┇.سورة [اسم السورة] ⌯』(لتشغيل سورة صوتيًا)  
✦❐┇.اسماء_الله ⌯』(لعرض أسماء الله الحسنى)  
✦❐┇.حديث ⌯』(للحصول على حديث نبوي)  
✦❐┇.دعاء ⌯』(للحصول على دعاء عشوائي)  
✦❐┇.سؤال_ديني ⌯』(للحصول على سؤال ديني عشوائي)  

╚⏤⏤━⌬ 📖 ⌬━⏤⏤╝

╰━━━━━━━━━━━━━━━━╯
❖ 𓆩 ⫷✧ ᴍɪᴋᴇʏ ʙᴏᴛ ✧⫸ 𓆪 ❖


`;

        conn.sendMessage(m.chat, { text: menu, mentions: [m.sender] });
    }

    if (command === 'سورة') {
        if (!text) return m.reply('❌ يرجى كتابة اسم السورة بعد الأمر، مثال: .سورة الفاتحة');
        let surah = encodeURIComponent(text);
        let apiUrl = `https://api.quran.com/api/v4/recitations/1/by_chapter/${surah}`;

        try {
            let response = await fetch(apiUrl);
            let data = await response.json();
            if (data.audio_file) {
                conn.sendMessage(m.chat, { audio: { url: data.audio_file }, mimetype: 'audio/mpeg' });
            } else {
                m.reply('⚠️ لم يتم العثور على السورة المطلوبة، تأكد من كتابتها بشكل صحيح.');
            }
        } catch (err) {
            console.error(err);
            m.reply('❌ حدث خطأ أثناء جلب السورة.');
        }
    }

    if (command === 'اسماء_الله') {
        let names = `✨ أسماء الله الحسنى ✨  
        
        1- الرحمن  
        2- الرحيم  
        3- الملك  
        4- القدوس  
        5- السلام  
        6- المؤمن  
        7- المهيمن  
        8- العزيز  
        9- الجبار  
        10- المتكبر  
        ...  
        99- الصبور`;

        conn.sendMessage(m.chat, { text: names });
    }

    if (command === 'حديث') {
        let hadiths = [
            "قال رسول الله ﷺ: (إنما الأعمال بالنيات وإنما لكل امرئ ما نوى).",
            "قال رسول الله ﷺ: (خيركم من تعلم القرآن وعلمه).",
            "قال رسول الله ﷺ: (الدين النصيحة).",
            "قال رسول الله ﷺ: (لا يؤمن أحدكم حتى يحب لأخيه ما يحب لنفسه).",
            "قال رسول الله ﷺ: (من كان يؤمن بالله واليوم الآخر فليقل خيرًا أو ليصمت).",
            "قال رسول الله ﷺ: (المسلم من سلم المسلمون من لسانه ويده).",
            "قال رسول الله ﷺ: (اتق الله حيثما كنت).",
            "قال رسول الله ﷺ: (تبسمك في وجه أخيك صدقة).",
            "قال رسول الله ﷺ: (من لا يشكر الناس لا يشكر الله).",
            "قال رسول الله ﷺ: (أحب الأعمال إلى الله أدومها وإن قل)."
        ];
        let randomHadith = hadiths[Math.floor(Math.random() * hadiths.length)];
        conn.sendMessage(m.chat, { text: randomHadith });
    }

    if (command === 'دعاء') {
        let duas = [
            "اللهم آتنا في الدنيا حسنة وفي الآخرة حسنة وقنا عذاب النار.",
            "اللهم إنك عفو تحب العفو فاعف عنا.",
            "اللهم اجعل القرآن ربيع قلوبنا ونور صدورنا.",
            "اللهم إني أسألك العافية في الدنيا والآخرة.",
            "اللهم ارزقني حسن الخاتمة.",
            "اللهم اغفر لي ولوالدي وللمسلمين أجمعين.",
            "اللهم ثبتني على دينك وطاعتك.",
            "اللهم احفظني من كل سوء.",
            "اللهم اجعلني من عبادك الصالحين.",
            "اللهم ارحم أمواتنا وأموات المسلمين."
        ];
        let randomDua = duas[Math.floor(Math.random() * duas.length)];
        conn.sendMessage(m.chat, { text: randomDua });
    }

    if (command === 'سؤال_ديني') {
        let questions = [
            "ما هي السورة التي تعدل ثلث القرآن؟ (الإجابة: سورة الإخلاص)",
            "كم عدد أركان الإسلام؟ (الإجابة: خمسة)",
            "ما أول صلاة فُرضت على النبي ﷺ؟ (الإجابة: صلاة الظهر)",
            "ما هو الركن الأول من أركان الإسلام؟ (الإجابة: الشهادتان)",
            "من هو أول الخلفاء الراشدين؟ (الإجابة: أبو بكر الصديق رضي الله عنه)",
            "كم عدد آيات القرآن الكريم؟ (الإجابة: 6236 آية)",
            "من هو الصحابي الملقب بـ 'سيف الله المسلول'؟ (الإجابة: خالد بن الوليد)",
            "ما هي أطول سورة في القرآن؟ (الإجابة: سورة البقرة)",
            "ما هي أقصر سورة في القرآن؟ (الإجابة: سورة الكوثر)",
            "من هو النبي الذي ابتلعه الحوت؟ (الإجابة: يونس عليه السلام)"
        ];
        let randomQuestion = questions[Math.floor(Math.random() * questions.length)];
        conn.sendMessage(m.chat, { text: randomQuestion });
    }

};

handler.help = ['اسلام', 'سورة', 'اسماء_الله', 'حديث', 'دعاء', 'سؤال_ديني'];
handler.tags = ['islamic'];
handler.command = ['اسلام', 'سورة', 'اسماء_الله', 'حديث', 'دعاء', 'سؤال_ديني'];
handler.fail = null;

export default handler;